EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd,data=yield_ndvi)
summary(lm1)
head(yield_evi)
lm1=  lm(yield_tn_ha ~factor(i)+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd,data=yield_evi)
summary(lm1)
library(plm)
install.packages("plm")
library(plm) # works on desktop at school
formula = yield_tn_ha ~factor(i)+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
lm1=  lm(formula,data=yield_evi)
summary(lm1)
mean((yield_evi$yield_tn_ha - predict(lm1, yield_evi))^2)/mean(yield_evi$yield_tn_ha)
lm_0=  lm(yield_tn_ha ~factor(i),data=yield_evi)
summary(lm_0)
View(yield_evi)
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
lm1=  lm(formula,data=yield_evi)
summary(lm1)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_sd
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_all_growing_5th_prct+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula2, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula2 = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula = yield_tn_ha ~season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
random <- plm(formula, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
phtest(fixed, random)
fitted = as.numeric(random$model[[1]] - random$residuals)
head(random$model)
dim(random$model)
dim(na.omit(yield_evi))
View(yield_evi)
formula = yield_tn_ha ~factor(i)+plant_dates+haverest_dates+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
lm1=  lm(formula,data=yield_evi)
formula = yield_tn_ha ~factor(i)+plant_dates+harvest_dates+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_growing_AUC_diff_mn+EVI_growing_AUC_diff_90th+EVI_all_growing_5th_prct+EVI_growing_sd
lm1=  lm(formula,data=yield_evi)
summary(lm1)
formula = yield_tn_ha ~plant_dates+harvest_dates+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
formula = yield_tn_ha ~plant_dates+harvest_dates+season_length+EVI_annual_mean+EVI_annual_min+EVI_annual_max+EVI_annual_AUC+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
library(plm) # works on desktop at school
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
random <- plm(formula, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
fitted = as.numeric(random$model[[1]] - random$residuals)
model_data = random$model
model_data = cbind(model_data,na.omit(yield_evi))
names(model_data)
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
ggplot(data=model_data,aes(x=years_id,y=yield_tn_ha,colour=district))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
library(ggplot)
library(ggplot2)
ggplot(data=model_data,aes(x=years_id,y=yield_tn_ha,colour=district))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
library(plyr)
library(reshape)
head(model_data[,c('district','years_id','yield_tn_ha','fitted')])
fitted = as.data.frame(fitted = random$model[[1]] - random$residuals)
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = melt(model_data[,c('district','years_id','yield_tn_ha','fitted')],)
head(model_data)
model_data = melt(model_data[,c('district','years_id','yield_tn_ha','fitted')],id = 'years_id')
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
head(model_data,melt(,id = 'years_id'))
head(data=model_data,melt(,id = 'years_id'))
head(melt(model_data,id = 'years_id'))
head(melt(model_data,id = 'years_id','district'))
head(melt(model_data,id = c('years_id','district')))
model_data = melt(model_data,id = c('years_id','district'))
View(model_data)
ggplot(data=model_data,aes(x=years_id,y=yield_tn_ha,colour=district))+
geom_point() + facet_wrap( ~ district + variable)+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")+
()
ggplot(data=model_data,aes(x=years_id,y=yield_tn_ha,colour=district))+
geom_point() + facet_wrap( ~ district + variable)+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
ggplot(data=model_data,aes(x=years_id,y=value,colour=district))+
geom_point() + facet_wrap( ~ district + variable)+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
ggplot(data=model_data,aes(x=years_id,y=value,colour=variable))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
formula2 = yield_tn_ha ~  season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
random <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
fixed <- plm(formula, data=yield_evi, index=c("district", "years"), model="within")
summary(fixed)
random <- plm(formula, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~  season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
model_data = melt(model_data,id = c('years_id','district'))
ggplot(data=model_data,aes(x=years_id,y=value,colour=variable))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
formula2 = yield_tn_ha ~ plant_dates+harvest_dates+ season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_5th_prct+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+harvest_dates+ season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_AUC+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+harvest_dates+ season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_5th_prct+EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+I(EVI_annual_max^2)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2)+
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
model_data = melt(model_data,id = c('years_id','district'))
ggplot(data=model_data,aes(x=years_id,y=value,colour=variable))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+I(EVI_annual_AUC^3)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2)+
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2)+
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+I(plant_dates^2)+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2)+
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+I(EVI_growing_max_date^2)
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
formula2 = yield_tn_ha ~ plant_dates+season_length+EVI_annual_mean+I(EVI_annual_mean^2)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+I(EVI_growing_max_date^2)+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random2 <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random2)
random <- plm(formula2, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
model_data = melt(model_data,id = c('years_id','district'))
ggplot(data=model_data,aes(x=years_id,y=value,colour=variable))+
geom_point() + facet_wrap( ~ district )+xlab('Year')+ylab('Wheat Tons / ha')+ theme(legend.position="none")
install.packages("rms")
library(rms)
formula3 = yield_tn_ha ~ plant_dates+season_length+rcs(EVI_annual_mean,4)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
formula3 = yield_tn_ha ~ rcs(plant_dates,4)+rcs(season_length,4)+rcs(EVI_annual_mean,4)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
formula3 = yield_tn_ha ~ rcs(plant_dates,3)+rcs(season_length,3)+rcs(EVI_annual_mean,4)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
formula3 = yield_tn_ha ~  plant_dates +rcs(season_length,3)+rcs(EVI_annual_mean,4)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
formula3 = yield_tn_ha ~  plant_dates +season_length+rcs(EVI_annual_mean,4)+EVI_annual_min+EVI_annual_max+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
formula3 = yield_tn_ha ~  plant_dates +season_length+rcs(EVI_annual_mean,4)+EVI_annual_min+rcs(EVI_annual_max,4)+
EVI_annual_AUC+I(EVI_annual_AUC^2)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
formula3 = yield_tn_ha ~  plant_dates +season_length+rcs(EVI_annual_mean,4)+EVI_annual_min+rcs(EVI_annual_max,4)+
rcs(EVI_annual_AUC,4)+
EVI_annual_5th_prct+EVI_annual_sd+EVI_annual_max_5th_prct+EVI_annual_AUC_5th_prct+EVI_growing_max_date+
EVI_growing_mean+EVI_growing_min+EVI_growing_max+EVI_growing_max_5th_prct+
EVI_growing_AUC_v2+EVI_growing_AUC_leading+EVI_growing_AUC_trailing+
EVI_all_growing_5th_prct+EVI_growing_sd
#removed EVI_growing_5th_prct EVI_growing_AUC harvest_dates EVI_growing_AUC_5th_prct I(EVI_annual_max^2) I(plant_dates^2)
random <- plm(formula3, data=yield_evi, index=c("district", "years"), model="random")
summary(random)
# plot fitted vs actual
fitted = data.frame(fitted = random$model[[1]] - random$residuals)
model_data = cbind(random$model,fitted)
model_data = cbind(model_data,na.omit(yield_evi))
model_data$district = as.character(model_data$district)
model_data$years_id = as.numeric(substr(model_data$year,1,4))
model_data = model_data[,c('district','years_id','yield_tn_ha','fitted')]
model_data = melt(model_data,id = c('years_id','district'))
fitted
class(fitted)
class(random$model)
model_data = cbind(random$model,fitted)
head(random$model)
as.data.frame(random$model)
class(random$model)
str(random$model)
random$model$`rcs(EVI_annual_mean, 4)`
str(random$model$`rcs(EVI_annual_mean, 4)`)
random$model$'rcs(EVI_annual_mean, 4)'
random$model$'rcs(EVI_annual_mean, 4)'[[1]]
random$model$'rcs(EVI_annual_mean, 4)'[1]
random$model$'rcs(EVI_annual_mean, 4)'[0]
random$model$'rcs(EVI_annual_mean, 4)'[[1]]
random$model$'rcs(EVI_annual_mean, 4)'[[1,2]]
random$model$'rcs(EVI_annual_mean, 4)'[[1,1]]
random$model$'rcs(EVI_annual_mean, 4)'[[1,3]]
random$model$'rcs(EVI_annual_mean, 4)'[[]]
random$model$'rcs(EVI_annual_mean, 4)'[[:,:]]
install.packages('rmarkdown')
library(rmarkdown)
install.packages("rticles", type = "source")
A=Appendix_Function_number; paste(A);Appendix_Function_number=Appendix_Function_number+1
setwd('H:/Projects/India_Index_Insurance/India_Index_Insurance_Code/WriteUp/')
source('H:/Scripts/multi_grep_character.R')
library(pander)
library(knitr)
library(plyr)
yield_ndvi = read.csv('..//yield_ndvi.csv')
focus_group = read.csv('Focus Groups Summary.csv',stringsAsFactors = F)
Table_number = 1
Figure_number = 1
Appendix_Table_number =1
Appendix_Function_number =1
E=Appendix_Function_number; paste(E);Appendix_Function_number=Appendix_Function_number+1
F=Appendix_Function_number; paste(F);Appendix_Function_number=Appendix_Function_number+1
G=Appendix_Function_number; paste(G);Appendix_Function_number=Appendix_Function_number+1
bench = read.csv('FigureTableData/benchmark_extract.csv')
library(ggplot2)
bench[2:,]
bench[2:length(bench),]
bench[2:dim(bench)[1],]
ggplot(data=bench[2:dim(bench)[1],],aes(x=cores,y=times))+geom_line()
ggplot(data=bench[2:dim(bench)[1],],aes(x=cores,y=times))+geom_path()
bench[2:dim(bench)[1],]
ggplot(data=bench[2:dim(bench)[1],],aes(x=cores,y=times,group=NULL))+geom_line()
bench = read.csv('FigureTableData/benchmark_extract.csv',stringsAsFactors = F)
ggplot(data=bench[2:dim(bench)[1],],aes(x=cores,y=times,group=NULL))+geom_line()
class(bench[,1])
class(bench[,2])
class(bench[,4])
class(bench[,3])
bench_extract_time = bench[1,1]
bench = bench[2:dim(bench)[1],]
bench$cores = as.numeric(bench$cores)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line()
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line()+geom_hline(yintercept =bench_extract_time,colour='red' )
bench = read.csv('FigureTableData/benchmark_extract.csv',stringsAsFactors = F)
bench_extract_time = bench[1,2] # remove text data
bench = bench[2:dim(bench)[1],]
bench$cores = as.numeric(bench$cores)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line()+geom_hline(yintercept =bench_extract_time,colour='red' )
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line()+geom_hline(yintercept =bench_extract_time,colour='red',size=2)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line()+geom_hline(yintercept =bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1,syle=2)+geom_hline(yintercept =bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1,style=2)+geom_hline(yintercept =bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1,type=2)+geom_hline(yintercept =bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1,type=2)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 3, y = 150, label = "extract_value_point_polygon")
```
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", xmin = 3, y = 150, label = "extract_value_point_polygon",)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", xmin = 3, y = 150, label = "extract_value_point_polygon",)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 10, y = 150, label = "extract_value_point_polygon",)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 9, y = 150, label = "extract_value_point_polygon",)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon",)
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon")+ annotate("text", x = 7, y = 280, label = "extract_value_point_polygon")
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon")+ annotate("text", x = 7, y = 290, label = "extract_value_point_polygon")
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon")+ annotate("text", x = 7, y = 290, label = "Raster::extract")
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon")+ annotate("text", x = 7, y = 287, label = "Raster::extract")
ggplot(data=bench,aes(x=cores,y=times,group=NULL))+geom_line(size=1)+geom_hline(yintercept=bench_extract_time,colour='red',size=1)+xlab('Cores')+ylab('User Time')+ annotate("text", x = 7, y = 150, label = "extract_value_point_polygon")+ annotate("text", x = 7, y = 287, label = "Raster::extract", col='red')
